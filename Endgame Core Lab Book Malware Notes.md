---
tag: curriculum-dev/endgame
type: elastic-work/kanban
frontend/backend: true
---

# Endgame Core Lab Book rewrite
## 2022-07-13 22:39

## Goal

Rewrite the Endgame Core lab book

## Malware Review - 2022-07-18 - 12:49

Consider adding "Retrieve New Data" to some of these steps? Maybe fits better in an instructor guide. The screenshots show more activity then the labs lead on. Maybe for each screenshot that shows more

Worth it to detail which samples will generate different types of alerts
Almost all will generate **Malicious File** (MalwareScore)
Some will generate **Process Injection**
- `potao1.exe`
- `sekur1.exe`
- `wce samples`

More domain names to add to hostfile

```
demotrendenablement.com
ubisortdasert.top
colektiv.info
advtravel.info
chromup.com
```

### Module 2 - Exercise 5 malware behaviors


`blackenergy1, blackenergy2, blackenergy4, blackenergy6, blackenergy7, blackenergy8, blackenergy9` - Show errors but still runs - `ntoskrnl.exe not found`
`blackenergy3` - Seemed the most stable/active 


`dropper1.exe` Generates and then deletes itself

`nitro1.exe` - Tries to resolve 223.25.233.248, resolves to localhost as expected

`rustock.exe` - Generates alerts and then deletes itself

`sample1.exe` - Generates a ton of alerts and also spawns a window

`sample2.exe` - Generates a few events and spawns a ton of commandline, ping and net. Then deletes itself. 

Windows Credential Editor
- Create a services to pull creds and generates three alerts on boot
`wce5.exe` - Is broken `Can't create new thread`
`wce6.exe`,`wce7.exe` - Could potentially break the lab. Tries to shut down the computer after. 


`winnti3.exe` - Deletes itself after it has ran


### Exercise 6

Need to reset malware detection in policy before running `potao1.exe`

Have to start Internet Explorer. Currently no shortcut on the desktop, Could just ask to run `iexplore.exe` for this exercise

### Exercise 7

Second time when you run `sekurlsa::logonpasswords` you get the error below
- `ERROR kuhl_m_sekurlsa_acquireLSA`

### Exercise 8

`uac_sdclt.py` is broken
`common.py` is broken too, - `C:\python27\lib\subprocess.py` must be hardcoded somewhere

Lateral movement to localhost, everything with `sc.exe` is broken it appears but might be expected behavior
- Opinion: The code is still running so even though it isn't completeling we still are meeting learning objectives. 

### Exercise 9
Adversary Behaviors - Reflex Response

### Exercise 10 - Creating Custom Rules
Found a bug where I was able to make my rule use Refex Response which didn't work but it did work when I updated it in my policy. 


## Module 4 - 2022-07-19 - 10:21
So far everything is good up to Exercise 6